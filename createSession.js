var subjectId = 999999959920;
var subjectNamespace = "uk.nhs.nhs_number";
var ehrId; 
var templateId = "IDCR%20-%20Problem%20List.v1";
var compositionId;
var openEhrApi = "http://178.62.71.220:8080";
var Ehr_Session;
var SessionHeader = "Ehr-Session"; 
var committerName = "Dr%20Franke";
var skipDeletes = true;
var lineSuccess = "<td><font COLOR='green'>PASS</font></td>";
var lineFailure = "<td><font COLOR='red'>FAIL</font></td>";

var dataTemp = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!--Operational template XML automatically generated by Ocean Template Designer Version 2.8.94Beta-->\r\n<template xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://schemas.openehr.org/v1\">\r\n  <language>\r\n    <terminology_id>\r\n      <value>ISO_639-1</value>\r\n    </terminology_id>\r\n    <code_string>en</code_string>\r\n  </language>\r\n  <description>\r\n    <original_author id=\"Original Author\">Not Specified</original_author>\r\n    <lifecycle_state>Initial</lifecycle_state>\r\n    <other_details id=\"MetaDataSet:Sample Set \">Template metadata sample set </other_details>\r\n    <other_details id=\"Acknowledgements\"/>\r\n    <other_details id=\"Business Process Level\"/>\r\n    <other_details id=\"Care setting\"/>\r\n    <other_details id=\"Client group\"/>\r\n    <other_details id=\"Clinical Record Element\"/>\r\n    <other_details id=\"Copyright\"/>\r\n    <other_details id=\"Issues\"/>\r\n    <other_details id=\"Owner\"/>\r\n    <other_details id=\"Sign off\"/>\r\n    <other_details id=\"Speciality\"/>\r\n    <other_details id=\"User roles\"/>\r\n    <details>\r\n      <language>\r\n        <terminology_id>\r\n          <value>ISO_639-1</value>\r\n        </terminology_id>\r\n        <code_string>en</code_string>\r\n      </language>\r\n      <purpose>Not Specified</purpose>\r\n    </details>\r\n  </description>\r\n  <uid>\r\n    <value>93c39e9e-86b0-45c7-a1ed-9752d8270011</value>\r\n  </uid>\r\n  <template_id>\r\n    <value>IDCR Problem List.v1</value>\r\n  </template_id>\r\n  <concept>IDCR Problem List.v1</concept>\r\n  <definition>\r\n    <rm_type_name>COMPOSITION</rm_type_name>\r\n    <occurrences>\r\n      <lower_included>true</lower_included>\r\n      <upper_included>true</upper_included>\r\n      <lower_unbounded>false</lower_unbounded>\r\n      <upper_unbounded>false</upper_unbounded>\r\n      <lower>1</lower>\r\n      <upper>1</upper>\r\n    </occurrences>\r\n    <node_id>at0000</node_id>\r\n    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n      <rm_attribute_name>category</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>1</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n        <rm_type_name>DV_CODED_TEXT</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>1</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id/>\r\n        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n          <rm_attribute_name>defining_code</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>1</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_CODE_PHRASE\">\r\n            <rm_type_name>CODE_PHRASE</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <upper_included>true</upper_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>false</upper_unbounded>\r\n              <lower>1</lower>\r\n              <upper>1</upper>\r\n            </occurrences>\r\n            <node_id/>\r\n            <terminology_id>\r\n              <value>openehr</value>\r\n            </terminology_id>\r\n            <code_list>433</code_list>\r\n          </children>\r\n        </attributes>\r\n      </children>\r\n    </attributes>\r\n    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n      <rm_attribute_name>context</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>0</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n        <rm_type_name>EVENT_CONTEXT</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>1</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id/>\r\n        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n          <rm_attribute_name>other_context</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>0</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n            <rm_type_name>ITEM_TREE</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <upper_included>true</upper_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>false</upper_unbounded>\r\n              <lower>1</lower>\r\n              <upper>1</upper>\r\n            </occurrences>\r\n            <node_id>at0006</node_id>\r\n            <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n              <rm_attribute_name>items</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>0</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                <rm_type_name>CLUSTER</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>true</upper_unbounded>\r\n                  <lower>0</lower>\r\n                </occurrences>\r\n                <node_id>at0008</node_id>\r\n                <includes>\r\n                  <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                    <type>Boolean</type>\r\n                    <operator>2007</operator>\r\n                    <precedence_overridden>false</precedence_overridden>\r\n                    <left_operand xsi:type=\"EXPR_LEAF\">\r\n                      <type>String</type>\r\n                      <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                      <reference_type>attribute</reference_type>\r\n                    </left_operand>\r\n                    <right_operand xsi:type=\"EXPR_LEAF\">\r\n                      <type>C_STRING</type>\r\n                      <item xsi:type=\"C_STRING\">\r\n                        <pattern>.*</pattern>\r\n                      </item>\r\n                      <reference_type>constraint</reference_type>\r\n                    </right_operand>\r\n                  </expression>\r\n                </includes>\r\n              </children>\r\n              <cardinality>\r\n                <is_ordered>false</is_ordered>\r\n                <is_unique>false</is_unique>\r\n                <interval>\r\n                  <lower_included>true</lower_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>true</upper_unbounded>\r\n                  <lower>0</lower>\r\n                </interval>\r\n              </cardinality>\r\n            </attributes>\r\n          </children>\r\n        </attributes>\r\n      </children>\r\n    </attributes>\r\n    <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n      <rm_attribute_name>content</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>0</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n        <rm_type_name>EVALUATION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </occurrences>\r\n        <node_id>at0002</node_id>\r\n        <includes>\r\n          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n            <type>Boolean</type>\r\n            <operator>2007</operator>\r\n            <precedence_overridden>false</precedence_overridden>\r\n            <left_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>String</type>\r\n              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n              <reference_type>attribute</reference_type>\r\n            </left_operand>\r\n            <right_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>C_STRING</type>\r\n              <item xsi:type=\"C_STRING\">\r\n                <pattern>openEHR-EHR-EVALUATION\\.problem_diagnosis(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n              </item>\r\n              <reference_type>constraint</reference_type>\r\n            </right_operand>\r\n          </expression>\r\n        </includes>\r\n      </children>\r\n      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n        <rm_type_name>ACTION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </occurrences>\r\n        <node_id>at0003</node_id>\r\n        <includes>\r\n          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n            <type>Boolean</type>\r\n            <operator>2007</operator>\r\n            <precedence_overridden>false</precedence_overridden>\r\n            <left_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>String</type>\r\n              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n              <reference_type>attribute</reference_type>\r\n            </left_operand>\r\n            <right_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>C_STRING</type>\r\n              <item xsi:type=\"C_STRING\">\r\n                <pattern>openEHR-EHR-ACTION\\.procedure(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n              </item>\r\n              <reference_type>constraint</reference_type>\r\n            </right_operand>\r\n          </expression>\r\n        </includes>\r\n      </children>\r\n      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n        <rm_type_name>EVALUATION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </occurrences>\r\n        <node_id>at0004</node_id>\r\n        <includes>\r\n          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n            <type>Boolean</type>\r\n            <operator>2007</operator>\r\n            <precedence_overridden>false</precedence_overridden>\r\n            <left_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>String</type>\r\n              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n              <reference_type>attribute</reference_type>\r\n            </left_operand>\r\n            <right_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>C_STRING</type>\r\n              <item xsi:type=\"C_STRING\">\r\n                <pattern>openEHR-EHR-EVALUATION\\.exclusion-problem_diagnosis(-[a-zA-Z0-9_]+)*\\.v1|openEHR-EHR-EVALUATION\\.exclusion-procedure(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n              </item>\r\n              <reference_type>constraint</reference_type>\r\n            </right_operand>\r\n          </expression>\r\n        </includes>\r\n      </children>\r\n      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n        <rm_type_name>EVALUATION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </occurrences>\r\n        <node_id>at0005</node_id>\r\n        <includes>\r\n          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n            <type>Boolean</type>\r\n            <operator>2007</operator>\r\n            <precedence_overridden>false</precedence_overridden>\r\n            <left_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>String</type>\r\n              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n              <reference_type>attribute</reference_type>\r\n            </left_operand>\r\n            <right_operand xsi:type=\"EXPR_LEAF\">\r\n              <type>C_STRING</type>\r\n              <item xsi:type=\"C_STRING\">\r\n                <pattern>openEHR-EHR-EVALUATION\\.absence(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n              </item>\r\n              <reference_type>constraint</reference_type>\r\n            </right_operand>\r\n          </expression>\r\n        </includes>\r\n      </children>\r\n      <children xsi:type=\"C_ARCHETYPE_ROOT\">\r\n        <rm_type_name>SECTION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </occurrences>\r\n        <node_id>at0000</node_id>\r\n        <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n          <rm_attribute_name>items</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>0</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_ARCHETYPE_ROOT\">\r\n            <rm_type_name>EVALUATION</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>true</upper_unbounded>\r\n              <lower>0</lower>\r\n            </occurrences>\r\n            <node_id>at0000</node_id>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>data</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>1</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0001</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>1</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0002</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0009</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0012</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0039</node_id>\r\n                    <includes>\r\n                      <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                        <type>Boolean</type>\r\n                        <operator>2007</operator>\r\n                        <precedence_overridden>false</precedence_overridden>\r\n                        <left_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>String</type>\r\n                          <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                          <reference_type>attribute</reference_type>\r\n                        </left_operand>\r\n                        <right_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>C_STRING</type>\r\n                          <item xsi:type=\"C_STRING\">\r\n                            <pattern>openEHR-EHR-CLUSTER\\.anatomical_location(-[a-zA-Z0-9_]+)*\\.v1|openEHR-EHR-CLUSTER\\.anatomical_location_clock(-[a-zA-Z0-9_]+)*\\.v0|openEHR-EHR-CLUSTER\\.anatomical_location_relative(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n                          </item>\r\n                          <reference_type>constraint</reference_type>\r\n                        </right_operand>\r\n                      </expression>\r\n                    </includes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0077</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_DATE_TIME</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0003</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_DATE_TIME</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0043</node_id>\r\n                    <includes>\r\n                      <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                        <type>Boolean</type>\r\n                        <operator>2007</operator>\r\n                        <precedence_overridden>false</precedence_overridden>\r\n                        <left_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>String</type>\r\n                          <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                          <reference_type>attribute</reference_type>\r\n                        </left_operand>\r\n                        <right_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>C_STRING</type>\r\n                          <item xsi:type=\"C_STRING\">\r\n                            <pattern>.*</pattern>\r\n                          </item>\r\n                          <reference_type>constraint</reference_type>\r\n                        </right_operand>\r\n                      </expression>\r\n                    </includes>\r\n                  </children>\r\n                  <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0046</node_id>\r\n                    <includes>\r\n                      <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                        <type>Boolean</type>\r\n                        <operator>2007</operator>\r\n                        <precedence_overridden>false</precedence_overridden>\r\n                        <left_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>String</type>\r\n                          <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                          <reference_type>attribute</reference_type>\r\n                        </left_operand>\r\n                        <right_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>C_STRING</type>\r\n                          <item xsi:type=\"C_STRING\">\r\n                            <pattern>openEHR-EHR-CLUSTER\\.problem_status(-[a-zA-Z0-9_]+)*\\.v0</pattern>\r\n                          </item>\r\n                          <reference_type>constraint</reference_type>\r\n                        </right_operand>\r\n                      </expression>\r\n                    </includes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0073</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_CODED_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>1</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>protocol</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>0</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0032</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0070</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_DATE_TIME</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id/>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0071</node_id>\r\n                    <includes>\r\n                      <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                        <type>Boolean</type>\r\n                        <operator>2007</operator>\r\n                        <precedence_overridden>false</precedence_overridden>\r\n                        <left_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>String</type>\r\n                          <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                          <reference_type>attribute</reference_type>\r\n                        </left_operand>\r\n                        <right_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>C_STRING</type>\r\n                          <item xsi:type=\"C_STRING\">\r\n                            <pattern>.*</pattern>\r\n                          </item>\r\n                          <reference_type>constraint</reference_type>\r\n                        </right_operand>\r\n                      </expression>\r\n                    </includes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <archetype_id>\r\n              <value>openEHR-EHR-EVALUATION.problem_diagnosis.v1</value>\r\n            </archetype_id>\r\n            <term_definitions code=\"at0000\">\r\n              <items id=\"comment\">Clear delineation between the scope of a problem versus a diagnosis is not easy to achieve in practice. For the purposes of clinical documentation with this archetype, problem and diagnosis are regarded as a continuum, with increasing levels of detail and supportive evidence usually providing weight towards the label of 'diagnosis'.</items>\r\n              <items id=\"description\">Details about a single identified health condition, injury, disability or any other issue which impacts on the physical, mental and/or social well-being of an individual.</items>\r\n              <items id=\"text\">Problem/Diagnosis</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0001\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">structure</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0002\">\r\n              <items id=\"comment\">Coding of the name of the problem or diagnosis with a terminology is preferred, where possible.</items>\r\n              <items id=\"description\">Identification of the problem or diagnosis, by name.</items>\r\n              <items id=\"text\">Problem/Diagnosis name</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0003\">\r\n              <items id=\"comment\">Partial dates are acceptable. If the subject of care is under the age of one year, then the complete date or a minimum of the month and year is necessary to enable accurate age calculations - for example, if used to drive decision support. Data captured/imported as \"Age at time of clinical recognition\" should be converted to a date using the subject's date of birth.</items>\r\n              <items id=\"description\">Estimated or actual date/time the diagnosis or problem was recognised by a healthcare professional.</items>\r\n              <items id=\"text\">Date/time clinically recognised</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0005\">\r\n              <items id=\"comment\">If severity is included in the Problem/diagnosis name via precoordinated codes, this data element becomes redundant. Note: more specific grading of severity can be recorded using the Specific details SLOT.</items>\r\n              <items id=\"description\">An assessment of the overall severity of the problem or diagnosis.</items>\r\n              <items id=\"text\">Severity</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0009\">\r\n              <items id=\"comment\">Use to provide background and context, including evolution, episodes or exacerbations, progress and any other relevant details, about the problem or diagnosis.</items>\r\n              <items id=\"description\">Narrative description about the problem or diagnosis.</items>\r\n              <items id=\"text\">Clinical description</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0012\">\r\n              <items id=\"comment\">Coding of the name of the anatomical location with a terminology is preferred, where possible.\r\nUse this data element to record precoordinated anatomical locations. If the requirements for recording the anatomical location are determined at run-time by the application or require more complex modelling such as relative locations then use the CLUSTER.anatomical_location or CLUSTER.relative_location within the 'Structured anatomical location' SLOT in this archetype. Occurrences for this data element are unbounded to allow for clinical scenarios such as describing a rash in multiple locations but where all of the other attributes are identical. If the anatomical location is included in the Problem/diagnosis name via precoordinated codes, this data element becomes redundant. \r\n\r\n</items>\r\n              <items id=\"description\">Identification of a simple body site for the location of the problem or diagnosis.</items>\r\n              <items id=\"text\">Body site</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0030\">\r\n              <items id=\"comment\">Partial dates are acceptable. If the subject of care is under the age of one year, then the complete date or a minimum of the month and year is necessary to enable accurate age calculations - for example, if used to drive decision support. Data captured/imported as \"Age at time of resolution\" should be converted to a date using the subject's date of birth.\r\n</items>\r\n              <items id=\"description\">Estimated or actual date/time of resolution or remission for this problem or diagnosis, as determined by a healthcare professional.</items>\r\n              <items id=\"text\">Date/time of resolution</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0032\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">Tree</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0039\">\r\n              <items id=\"comment\">Use this SLOT to insert the CLUSTER.anatomical_location or CLUSTER.relative_location archetypes if the requirements for recording the anatomical location are determined at run-time by the application or require more complex modelling such as relative locations.\r\n\r\nIf the anatomical location is included in the Problem/diagnosis name via precoordinated codes, use of this SLOT becomes redundant.\r\n\r\n</items>\r\n              <items id=\"description\">A structured anatomical location for the problem or diagnosis.</items>\r\n              <items id=\"text\">Structured body site</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0043\">\r\n              <items id=\"comment\">May include structured detail about the grading or staging of the diagnosis; diagnostic criteria, classification criteria or formal severity assessments such as Common Terminology Criteria for Adverse Events.</items>\r\n              <items id=\"description\">Details that are additionally required to record as unique attributes of this problem or diagnosis.</items>\r\n              <items id=\"text\">Specific details</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0046\">\r\n              <items id=\"comment\">Use status or context qualifiers with care, as they are variably used in practice and interoperability cannot be assured unless usage is clearly defined with the community of use. For example: active status - active, inactive, resolved, in remission; evolution status - initial, interim/working, final; temporal status - current, past; episodicity status - first, new, ongoing; admission status - admission, discharge; or priority status - primary, secondary.</items>\r\n              <items id=\"description\">Structured details for location-, domain-, episode- or workflow-specific aspects of the diagnostic process.</items>\r\n              <items id=\"text\">Status</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0047\">\r\n              <items id=\"description\">The problem or diagnosis does not interfere with normal activity or may cause damage to health if left untreated.</items>\r\n              <items id=\"text\">Mild</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0048\">\r\n              <items id=\"description\">The problem or diagnosis causes interference with normal activity or will damage health if left untreated.</items>\r\n              <items id=\"text\">Moderate</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0049\">\r\n              <items id=\"description\">The problem or diagnosis prevents normal activity or will seriously damage health if left untreated.</items>\r\n              <items id=\"text\">Severe</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0069\">\r\n              <items id=\"description\">Additional narrative about the problem or diagnosis not captured in other fields.</items>\r\n              <items id=\"text\">Comment</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0070\">\r\n              <items id=\"description\">The date this problem or diagnosis was last updated.</items>\r\n              <items id=\"text\">Last updated</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0071\">\r\n              <items id=\"comment\">For example: local information requirements or additional metadata to align with FHIR or CIMI equivalents.</items>\r\n              <items id=\"description\">Additional information required to capture local content or to align with other reference models/formalisms.</items>\r\n              <items id=\"text\">Extension</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0072\">\r\n              <items id=\"description\">Narrative description about the course of the problem or diagnosis since onset.</items>\r\n              <items id=\"text\">Course description</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0073\">\r\n              <items id=\"description\">The level of confidence in the identification of the diagnosis.</items>\r\n              <items id=\"text\">Diagnostic certainty</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0074\">\r\n              <items id=\"description\">The diagnosis has been identified with a low level of certainty.</items>\r\n              <items id=\"text\">Suspected</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0075\">\r\n              <items id=\"description\">The diagnosis has been identified with a high level of certainty.</items>\r\n              <items id=\"text\">Probable</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0076\">\r\n              <items id=\"description\">The diagnosis has been confirmed against recognised criteria.</items>\r\n              <items id=\"text\">Confirmed</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0077\">\r\n              <items id=\"comment\">Data captured/imported as \"Age at onset\" should be converted to a date using the subject's date of birth.</items>\r\n              <items id=\"description\">Estimated or actual date/time that signs or symptoms of the problem/diagnosis were first observed.</items>\r\n              <items id=\"text\">Date/time of onset</items>\r\n            </term_definitions>\r\n          </children>\r\n          <cardinality>\r\n            <is_ordered>false</is_ordered>\r\n            <is_unique>false</is_unique>\r\n            <interval>\r\n              <lower_included>true</lower_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>true</upper_unbounded>\r\n              <lower>0</lower>\r\n            </interval>\r\n          </cardinality>\r\n        </attributes>\r\n        <archetype_id>\r\n          <value>openEHR-EHR-SECTION.problems_issues_rcp.v1</value>\r\n        </archetype_id>\r\n        <term_definitions code=\"at0000\">\r\n          <items id=\"description\">Problems and issues heading (AoMRC).</items>\r\n          <items id=\"text\">Problems and issues</items>\r\n        </term_definitions>\r\n      </children>\r\n      <cardinality>\r\n        <is_ordered>false</is_ordered>\r\n        <is_unique>false</is_unique>\r\n        <interval>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>1</lower>\r\n        </interval>\r\n      </cardinality>\r\n    </attributes>\r\n    <archetype_id>\r\n      <value>openEHR-EHR-COMPOSITION.problem_list.v1</value>\r\n    </archetype_id>\r\n    <template_id>\r\n      <value>IDCR Problem List.v1</value>\r\n    </template_id>\r\n    <term_definitions code=\"at0000\">\r\n      <items id=\"description\">A persistent and managed list of any combination of diagnoses, problems and/or procedures that may influence clinical decision-making and care provision for the subject of care.</items>\r\n      <items id=\"text\">Problem list</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0002\">\r\n      <items id=\"description\">Detail about identified problems, diagnoses, concerns or health issue threads.</items>\r\n      <items id=\"text\">Problems, diagnoses, concerns or Health issue threads</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0003\">\r\n      <items id=\"description\">Detail about identified procedures that have been performed.</items>\r\n      <items id=\"text\">Procedures</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0004\">\r\n      <items id=\"comment\">For example: \"No significant problems or diagnoses\" or \"No history of significant operations or procedures\".</items>\r\n      <items id=\"description\">Positive statement about the exclusion of known problems or diagnoses and procedures performed.</items>\r\n      <items id=\"text\">Exclusion statements</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0005\">\r\n      <items id=\"description\">Positive statement that no information is available about identification of problems or diagnoses, nor procedures performed.</items>\r\n      <items id=\"text\">Absent information</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0006\">\r\n      <items id=\"description\">@ internal @</items>\r\n      <items id=\"text\">Tree</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0007\">\r\n      <items id=\"description\">SLOT to contain SECTION archetypes which support alternative modelling patterns for Problem lists in specific clinical scenarios.</items>\r\n      <items id=\"text\">Other</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0008\">\r\n      <items id=\"comment\">For example: Local hospital departmental infomation or additional metadata to align with FHIR or CIMI equivalents.</items>\r\n      <items id=\"description\">Additional information required to capture local context or to align with other reference models/formalisms.</items>\r\n      <items id=\"text\">Extension</items>\r\n    </term_definitions>\r\n  </definition>\r\n  <view>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.problem_list.v1]/content[openEHR-EHR-SECTION.problems_issues_rcp.v1]/items[openEHR-EHR-EVALUATION.problem_diagnosis.v1]/data[at0001]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.problem_list.v1]/content[openEHR-EHR-SECTION.problems_issues_rcp.v1]/items[openEHR-EHR-EVALUATION.problem_diagnosis.v1]/protocol[at0032]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n  </view>\r\n</template>"
var tempAllergies = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<!--Operational template XML automatically generated by Ocean Template Designer Version 2.8.94Beta-->\r\n<template xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://schemas.openehr.org/v1\">\r\n  <language>\r\n    <terminology_id>\r\n      <value>ISO_639-1</value>\r\n    </terminology_id>\r\n    <code_string>en</code_string>\r\n  </language>\r\n  <description>\r\n    <original_author id=\"Original Author\">Not Specified</original_author>\r\n    <lifecycle_state>Initial</lifecycle_state>\r\n    <other_details id=\"MetaDataSet:Sample Set \">Template metadata sample set </other_details>\r\n    <other_details id=\"Acknowledgements\"></other_details>\r\n    <other_details id=\"Business Process Level\"></other_details>\r\n    <other_details id=\"Care setting\"></other_details>\r\n    <other_details id=\"Client group\"></other_details>\r\n    <other_details id=\"Clinical Record Element\"></other_details>\r\n    <other_details id=\"Copyright\"></other_details>\r\n    <other_details id=\"Issues\"></other_details>\r\n    <other_details id=\"Owner\"></other_details>\r\n    <other_details id=\"Sign off\"></other_details>\r\n    <other_details id=\"Speciality\"></other_details>\r\n    <other_details id=\"User roles\"></other_details>\r\n    <details>\r\n      <language>\r\n        <terminology_id>\r\n          <value>ISO_639-1</value>\r\n        </terminology_id>\r\n        <code_string>en</code_string>\r\n      </language>\r\n      <purpose>Updated Allergies list to use FHIR/openEHR allergies/adverse reaction risk models, aligned with AoMRC headings</purpose>\r\n    </details>\r\n  </description>\r\n  <uid>\r\n    <value>f473e2ed-7f0a-41c9-9ef6-01632fe6c78b</value>\r\n  </uid>\r\n  <template_id>\r\n    <value>IDCR -  Adverse Reaction List.v1</value>\r\n  </template_id>\r\n  <concept>IDCR -  Adverse Reaction List.v1</concept>\r\n  <definition>\r\n    <rm_type_name>COMPOSITION</rm_type_name>\r\n    <occurrences>\r\n      <lower_included>true</lower_included>\r\n      <upper_included>true</upper_included>\r\n      <lower_unbounded>false</lower_unbounded>\r\n      <upper_unbounded>false</upper_unbounded>\r\n      <lower>1</lower>\r\n      <upper>1</upper>\r\n    </occurrences>\r\n    <node_id>at0000</node_id>\r\n    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n      <rm_attribute_name>category</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>1</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n        <rm_type_name>DV_CODED_TEXT</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>1</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id />\r\n        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n          <rm_attribute_name>defining_code</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>1</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_CODE_PHRASE\">\r\n            <rm_type_name>CODE_PHRASE</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <upper_included>true</upper_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>false</upper_unbounded>\r\n              <lower>1</lower>\r\n              <upper>1</upper>\r\n            </occurrences>\r\n            <node_id />\r\n            <terminology_id>\r\n              <value>openehr</value>\r\n            </terminology_id>\r\n            <code_list>433</code_list>\r\n          </children>\r\n        </attributes>\r\n      </children>\r\n    </attributes>\r\n    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n      <rm_attribute_name>context</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>0</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n        <rm_type_name>EVENT_CONTEXT</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>1</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id />\r\n        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n          <rm_attribute_name>other_context</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>0</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n            <rm_type_name>ITEM_TREE</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <upper_included>true</upper_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>false</upper_unbounded>\r\n              <lower>1</lower>\r\n              <upper>1</upper>\r\n            </occurrences>\r\n            <node_id>at0001</node_id>\r\n            <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n              <rm_attribute_name>items</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>0</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                <rm_type_name>CLUSTER</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>true</upper_unbounded>\r\n                  <lower>0</lower>\r\n                </occurrences>\r\n                <node_id>at0002</node_id>\r\n                <includes>\r\n                  <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                    <type>Boolean</type>\r\n                    <operator>2007</operator>\r\n                    <precedence_overridden>false</precedence_overridden>\r\n                    <left_operand xsi:type=\"EXPR_LEAF\">\r\n                      <type>String</type>\r\n                      <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                      <reference_type>attribute</reference_type>\r\n                    </left_operand>\r\n                    <right_operand xsi:type=\"EXPR_LEAF\">\r\n                      <type>C_STRING</type>\r\n                      <item xsi:type=\"C_STRING\">\r\n                        <pattern>.*</pattern>\r\n                      </item>\r\n                      <reference_type>constraint</reference_type>\r\n                    </right_operand>\r\n                  </expression>\r\n                </includes>\r\n              </children>\r\n              <cardinality>\r\n                <is_ordered>false</is_ordered>\r\n                <is_unique>false</is_unique>\r\n                <interval>\r\n                  <lower_included>true</lower_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>true</upper_unbounded>\r\n                  <lower>0</lower>\r\n                </interval>\r\n              </cardinality>\r\n            </attributes>\r\n          </children>\r\n        </attributes>\r\n      </children>\r\n    </attributes>\r\n    <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n      <rm_attribute_name>content</rm_attribute_name>\r\n      <existence>\r\n        <lower_included>true</lower_included>\r\n        <upper_included>true</upper_included>\r\n        <lower_unbounded>false</lower_unbounded>\r\n        <upper_unbounded>false</upper_unbounded>\r\n        <lower>0</lower>\r\n        <upper>1</upper>\r\n      </existence>\r\n      <children xsi:type=\"C_ARCHETYPE_ROOT\">\r\n        <rm_type_name>SECTION</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>0</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id>at0000</node_id>\r\n        <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n          <rm_attribute_name>items</rm_attribute_name>\r\n          <existence>\r\n            <lower_included>true</lower_included>\r\n            <upper_included>true</upper_included>\r\n            <lower_unbounded>false</lower_unbounded>\r\n            <upper_unbounded>false</upper_unbounded>\r\n            <lower>0</lower>\r\n            <upper>1</upper>\r\n          </existence>\r\n          <children xsi:type=\"C_ARCHETYPE_ROOT\">\r\n            <rm_type_name>EVALUATION</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <upper_included>true</upper_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>false</upper_unbounded>\r\n              <lower>0</lower>\r\n              <upper>1</upper>\r\n            </occurrences>\r\n            <node_id>at0000.1</node_id>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>data</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>1</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0001</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>1</lower>\r\n                    </occurrences>\r\n                    <node_id>at0002.1</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>1</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>protocol</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>0</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0006</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0004</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_DATE_TIME</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <archetype_id>\r\n              <value>openEHR-EHR-EVALUATION.exclusion-adverse_reaction.v1</value>\r\n            </archetype_id>\r\n            <term_definitions code=\"at0000\">\r\n              <items id=\"description\">Generic, positive statement/s that need to be recorded as clinically excluded from the health record at a specific point in time.</items>\r\n              <items id=\"text\">Exclusion Statement</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0000.1\">\r\n              <items id=\"description\">Positive statement/s about adverse reactions that need to be recorded as clinically excluded from the health record at a specific point in time.</items>\r\n              <items id=\"text\">Exclusion of an Adverse Reaction</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0001\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">Tree</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0002\">\r\n              <items id=\"comment\">Use to capture any information that is needed to be positively recorded as being excluded within the record. The statement can support recording global statements or statements about a specified object. See specialisations for Medications, Adverse Reactions, Problem/Diagnosis and Procedures as common examples that have been explicitly modelled.</items>\r\n              <items id=\"description\">The statement about an exclusion in the health record.</items>\r\n              <items id=\"text\">Exclusion Statement</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0002.1\">\r\n              <items id=\"comment\">For example: \"No known adverse reactions\"; \"No known adverse reaction to\" (penicillin).</items>\r\n              <items id=\"description\">A statement about exclusion of known adverse reactions in the health record.</items>\r\n              <items id=\"text\">Exclusion Statement</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0003\">\r\n              <items id=\"description\">Identification of the specific object/s to which the Exclusion Statement applies.</items>\r\n              <items id=\"text\">Specific Object</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0003.1\">\r\n              <items id=\"comment\">Coding of the Substance/Agent with a terminology is desirable, where possible.</items>\r\n              <items id=\"description\">Identification of the specific substance or agent to which the Exclusion Statement applies.</items>\r\n              <items id=\"text\">Substance/Agent</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0004\">\r\n              <items id=\"description\">The date at which the exclusion was last clinically asserted, affirmed or confirmed.</items>\r\n              <items id=\"text\">Date Last Updated</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0006\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">Tree</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0007\">\r\n              <items id=\"description\">Additional narrative about the Exclusion not captured in other fields.</items>\r\n              <items id=\"text\">Comment</items>\r\n            </term_definitions>\r\n          </children>\r\n          <children xsi:type=\"C_ARCHETYPE_ROOT\">\r\n            <rm_type_name>EVALUATION</rm_type_name>\r\n            <occurrences>\r\n              <lower_included>true</lower_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>true</upper_unbounded>\r\n              <lower>0</lower>\r\n            </occurrences>\r\n            <node_id>at0000</node_id>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>data</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>1</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0001</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>1</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0002</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                      </children>\r\n                    </attributes>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>name</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>1</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>1</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_PRIMITIVE_OBJECT\">\r\n                            <rm_type_name>STRING</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                            <item xsi:type=\"C_STRING\">\r\n                              <list>Causative agent</list>\r\n                            </item>\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0009</node_id>\r\n                    <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>items</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>1</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>ELEMENT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>0</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id>at0021</node_id>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>0</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_CODED_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                              <rm_attribute_name>defining_code</rm_attribute_name>\r\n                              <existence>\r\n                                <lower_included>true</lower_included>\r\n                                <upper_included>true</upper_included>\r\n                                <lower_unbounded>false</lower_unbounded>\r\n                                <upper_unbounded>false</upper_unbounded>\r\n                                <lower>1</lower>\r\n                                <upper>1</upper>\r\n                              </existence>\r\n                              <children xsi:type=\"C_CODE_PHRASE\">\r\n                                <rm_type_name>CODE_PHRASE</rm_type_name>\r\n                                <occurrences>\r\n                                  <lower_included>true</lower_included>\r\n                                  <upper_included>true</upper_included>\r\n                                  <lower_unbounded>false</lower_unbounded>\r\n                                  <upper_unbounded>false</upper_unbounded>\r\n                                  <lower>1</lower>\r\n                                  <upper>1</upper>\r\n                                </occurrences>\r\n                                <node_id />\r\n                                <terminology_id>\r\n                                  <value>local</value>\r\n                                </terminology_id>\r\n                                <code_list>at0095</code_list>\r\n                                <code_list>at0023</code_list>\r\n                                <code_list>at0118</code_list>\r\n                              </children>\r\n                            </attributes>\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>ELEMENT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0011</node_id>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>0</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>ELEMENT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>0</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id>at0089</node_id>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>0</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_CODED_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                          </children>\r\n                        </attributes>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>name</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>1</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                              <rm_attribute_name>value</rm_attribute_name>\r\n                              <existence>\r\n                                <lower_included>true</lower_included>\r\n                                <upper_included>true</upper_included>\r\n                                <lower_unbounded>false</lower_unbounded>\r\n                                <upper_unbounded>false</upper_unbounded>\r\n                                <lower>1</lower>\r\n                                <upper>1</upper>\r\n                              </existence>\r\n                              <children xsi:type=\"C_PRIMITIVE_OBJECT\">\r\n                                <rm_type_name>STRING</rm_type_name>\r\n                                <occurrences>\r\n                                  <lower_included>true</lower_included>\r\n                                  <upper_included>true</upper_included>\r\n                                  <lower_unbounded>false</lower_unbounded>\r\n                                  <upper_unbounded>false</upper_unbounded>\r\n                                  <lower>1</lower>\r\n                                  <upper>1</upper>\r\n                                </occurrences>\r\n                                <node_id />\r\n                                <item xsi:type=\"C_STRING\">\r\n                                  <list>Severity</list>\r\n                                </item>\r\n                              </children>\r\n                            </attributes>\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                        <rm_type_name>CLUSTER</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0029</node_id>\r\n                        <includes>\r\n                          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                            <type>Boolean</type>\r\n                            <operator>2007</operator>\r\n                            <precedence_overridden>false</precedence_overridden>\r\n                            <left_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>String</type>\r\n                              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                              <reference_type>attribute</reference_type>\r\n                            </left_operand>\r\n                            <right_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>C_STRING</type>\r\n                              <item xsi:type=\"C_STRING\">\r\n                                <pattern>openEHR-EHR-CLUSTER\\.anatomical_location(-[a-zA-Z0-9_]+)*\\.v1|openEHR-EHR-CLUSTER\\.multimedia(-[a-zA-Z0-9_]+)*\\.v1|openEHR-EHR-CLUSTER\\.anatomical_location_relative(-[a-zA-Z0-9_]+)*\\.v1|openEHR-EHR-CLUSTER\\.symptom_sign(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n                              </item>\r\n                              <reference_type>constraint</reference_type>\r\n                            </right_operand>\r\n                          </expression>\r\n                        </includes>\r\n                      </children>\r\n                      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                        <rm_type_name>CLUSTER</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0096</node_id>\r\n                        <includes>\r\n                          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                            <type>Boolean</type>\r\n                            <operator>2007</operator>\r\n                            <precedence_overridden>false</precedence_overridden>\r\n                            <left_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>String</type>\r\n                              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                              <reference_type>attribute</reference_type>\r\n                            </left_operand>\r\n                            <right_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>C_STRING</type>\r\n                              <item xsi:type=\"C_STRING\">\r\n                                <pattern>openEHR-EHR-CLUSTER\\.citation(-[a-zA-Z0-9_]+)*\\.v1</pattern>\r\n                              </item>\r\n                              <reference_type>constraint</reference_type>\r\n                            </right_operand>\r\n                          </expression>\r\n                        </includes>\r\n                      </children>\r\n                      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                        <rm_type_name>CLUSTER</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0119</node_id>\r\n                        <includes>\r\n                          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                            <type>Boolean</type>\r\n                            <operator>2007</operator>\r\n                            <precedence_overridden>false</precedence_overridden>\r\n                            <left_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>String</type>\r\n                              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                              <reference_type>attribute</reference_type>\r\n                            </left_operand>\r\n                            <right_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>C_STRING</type>\r\n                              <item xsi:type=\"C_STRING\">\r\n                                <pattern>.*</pattern>\r\n                              </item>\r\n                              <reference_type>constraint</reference_type>\r\n                            </right_operand>\r\n                          </expression>\r\n                        </includes>\r\n                      </children>\r\n                      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                        <rm_type_name>CLUSTER</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0041</node_id>\r\n                        <includes>\r\n                          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                            <type>Boolean</type>\r\n                            <operator>2007</operator>\r\n                            <precedence_overridden>false</precedence_overridden>\r\n                            <left_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>String</type>\r\n                              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                              <reference_type>attribute</reference_type>\r\n                            </left_operand>\r\n                            <right_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>C_STRING</type>\r\n                              <item xsi:type=\"C_STRING\">\r\n                                <pattern>.*</pattern>\r\n                              </item>\r\n                              <reference_type>constraint</reference_type>\r\n                            </right_operand>\r\n                          </expression>\r\n                        </includes>\r\n                      </children>\r\n                      <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                        <rm_type_name>CLUSTER</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>0</lower>\r\n                        </occurrences>\r\n                        <node_id>at0116</node_id>\r\n                        <includes>\r\n                          <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                            <type>Boolean</type>\r\n                            <operator>2007</operator>\r\n                            <precedence_overridden>false</precedence_overridden>\r\n                            <left_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>String</type>\r\n                              <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                              <reference_type>attribute</reference_type>\r\n                            </left_operand>\r\n                            <right_operand xsi:type=\"EXPR_LEAF\">\r\n                              <type>C_STRING</type>\r\n                              <item xsi:type=\"C_STRING\">\r\n                                <pattern>.*</pattern>\r\n                              </item>\r\n                              <reference_type>constraint</reference_type>\r\n                            </right_operand>\r\n                          </expression>\r\n                        </includes>\r\n                      </children>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>ELEMENT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>0</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id>at0032</node_id>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>0</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                          </children>\r\n                        </attributes>\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>name</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>1</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                            <rm_type_name>DV_TEXT</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                              <rm_attribute_name>value</rm_attribute_name>\r\n                              <existence>\r\n                                <lower_included>true</lower_included>\r\n                                <upper_included>true</upper_included>\r\n                                <lower_unbounded>false</lower_unbounded>\r\n                                <upper_unbounded>false</upper_unbounded>\r\n                                <lower>1</lower>\r\n                                <upper>1</upper>\r\n                              </existence>\r\n                              <children xsi:type=\"C_PRIMITIVE_OBJECT\">\r\n                                <rm_type_name>STRING</rm_type_name>\r\n                                <occurrences>\r\n                                  <lower_included>true</lower_included>\r\n                                  <upper_included>true</upper_included>\r\n                                  <lower_unbounded>false</lower_unbounded>\r\n                                  <upper_unbounded>false</upper_unbounded>\r\n                                  <lower>1</lower>\r\n                                  <upper>1</upper>\r\n                                </occurrences>\r\n                                <node_id />\r\n                                <item xsi:type=\"C_STRING\">\r\n                                  <list>Comment</list>\r\n                                </item>\r\n                              </children>\r\n                            </attributes>\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                      <cardinality>\r\n                        <is_ordered>false</is_ordered>\r\n                        <is_unique>false</is_unique>\r\n                        <interval>\r\n                          <lower_included>true</lower_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>true</upper_unbounded>\r\n                          <lower>1</lower>\r\n                        </interval>\r\n                      </cardinality>\r\n                    </attributes>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>name</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>1</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_TEXT</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                        <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                          <rm_attribute_name>value</rm_attribute_name>\r\n                          <existence>\r\n                            <lower_included>true</lower_included>\r\n                            <upper_included>true</upper_included>\r\n                            <lower_unbounded>false</lower_unbounded>\r\n                            <upper_unbounded>false</upper_unbounded>\r\n                            <lower>1</lower>\r\n                            <upper>1</upper>\r\n                          </existence>\r\n                          <children xsi:type=\"C_PRIMITIVE_OBJECT\">\r\n                            <rm_type_name>STRING</rm_type_name>\r\n                            <occurrences>\r\n                              <lower_included>true</lower_included>\r\n                              <upper_included>true</upper_included>\r\n                              <lower_unbounded>false</lower_unbounded>\r\n                              <upper_unbounded>false</upper_unbounded>\r\n                              <lower>1</lower>\r\n                              <upper>1</upper>\r\n                            </occurrences>\r\n                            <node_id />\r\n                            <item xsi:type=\"C_STRING\">\r\n                              <list>Reaction details</list>\r\n                            </item>\r\n                          </children>\r\n                        </attributes>\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>1</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n              <rm_attribute_name>protocol</rm_attribute_name>\r\n              <existence>\r\n                <lower_included>true</lower_included>\r\n                <upper_included>true</upper_included>\r\n                <lower_unbounded>false</lower_unbounded>\r\n                <upper_unbounded>false</upper_unbounded>\r\n                <lower>0</lower>\r\n                <upper>1</upper>\r\n              </existence>\r\n              <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                <rm_type_name>ITEM_TREE</rm_type_name>\r\n                <occurrences>\r\n                  <lower_included>true</lower_included>\r\n                  <upper_included>true</upper_included>\r\n                  <lower_unbounded>false</lower_unbounded>\r\n                  <upper_unbounded>false</upper_unbounded>\r\n                  <lower>1</lower>\r\n                  <upper>1</upper>\r\n                </occurrences>\r\n                <node_id>at0042</node_id>\r\n                <attributes xsi:type=\"C_MULTIPLE_ATTRIBUTE\">\r\n                  <rm_attribute_name>items</rm_attribute_name>\r\n                  <existence>\r\n                    <lower_included>true</lower_included>\r\n                    <upper_included>true</upper_included>\r\n                    <lower_unbounded>false</lower_unbounded>\r\n                    <upper_unbounded>false</upper_unbounded>\r\n                    <lower>0</lower>\r\n                    <upper>1</upper>\r\n                  </existence>\r\n                  <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                    <rm_type_name>ELEMENT</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <upper_included>true</upper_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>false</upper_unbounded>\r\n                      <lower>0</lower>\r\n                      <upper>1</upper>\r\n                    </occurrences>\r\n                    <node_id>at0062</node_id>\r\n                    <attributes xsi:type=\"C_SINGLE_ATTRIBUTE\">\r\n                      <rm_attribute_name>value</rm_attribute_name>\r\n                      <existence>\r\n                        <lower_included>true</lower_included>\r\n                        <upper_included>true</upper_included>\r\n                        <lower_unbounded>false</lower_unbounded>\r\n                        <upper_unbounded>false</upper_unbounded>\r\n                        <lower>0</lower>\r\n                        <upper>1</upper>\r\n                      </existence>\r\n                      <children xsi:type=\"C_COMPLEX_OBJECT\">\r\n                        <rm_type_name>DV_DATE_TIME</rm_type_name>\r\n                        <occurrences>\r\n                          <lower_included>true</lower_included>\r\n                          <upper_included>true</upper_included>\r\n                          <lower_unbounded>false</lower_unbounded>\r\n                          <upper_unbounded>false</upper_unbounded>\r\n                          <lower>1</lower>\r\n                          <upper>1</upper>\r\n                        </occurrences>\r\n                        <node_id />\r\n                      </children>\r\n                    </attributes>\r\n                  </children>\r\n                  <children xsi:type=\"ARCHETYPE_SLOT\">\r\n                    <rm_type_name>CLUSTER</rm_type_name>\r\n                    <occurrences>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>0</lower>\r\n                    </occurrences>\r\n                    <node_id>at0128</node_id>\r\n                    <includes>\r\n                      <expression xsi:type=\"EXPR_BINARY_OPERATOR\">\r\n                        <type>Boolean</type>\r\n                        <operator>2007</operator>\r\n                        <precedence_overridden>false</precedence_overridden>\r\n                        <left_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>String</type>\r\n                          <item xsi:type=\"xsd:string\">archetype_id/value</item>\r\n                          <reference_type>attribute</reference_type>\r\n                        </left_operand>\r\n                        <right_operand xsi:type=\"EXPR_LEAF\">\r\n                          <type>C_STRING</type>\r\n                          <item xsi:type=\"C_STRING\">\r\n                            <pattern>.*</pattern>\r\n                          </item>\r\n                          <reference_type>constraint</reference_type>\r\n                        </right_operand>\r\n                      </expression>\r\n                    </includes>\r\n                  </children>\r\n                  <cardinality>\r\n                    <is_ordered>false</is_ordered>\r\n                    <is_unique>false</is_unique>\r\n                    <interval>\r\n                      <lower_included>true</lower_included>\r\n                      <lower_unbounded>false</lower_unbounded>\r\n                      <upper_unbounded>true</upper_unbounded>\r\n                      <lower>1</lower>\r\n                    </interval>\r\n                  </cardinality>\r\n                </attributes>\r\n              </children>\r\n            </attributes>\r\n            <archetype_id>\r\n              <value>openEHR-EHR-EVALUATION.adverse_reaction_risk.v1</value>\r\n            </archetype_id>\r\n            <term_definitions code=\"at0000\">\r\n              <items id=\"comment\">Substances include, but are not limited to: a therapeutic substance administered correctly at an appropriate dosage for the individual; food; material derived from plants or animals; or venom from insect stings.</items>\r\n              <items id=\"description\">Risk of harmful or undesirable physiological response which is unique to an individual and associated with exposure to a substance.</items>\r\n              <items id=\"source\">openEHR,FHIR</items>\r\n              <items id=\"text\">Adverse reaction risk</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0001\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">Tree</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0002\">\r\n              <items id=\"comment\">Both an individual substance and a substance class are valid entries in 'Substance'. If the value in 'Substance' is an individual substance, it may be duplicated in 'Specific substance'. It is strongly recommended that both 'Substance' and 'Specific substance' be coded with a terminology capable of triggering decision support, where possible. For example: Snomed CT, DM+D, RxNorm, NDFRT, ATC, New Zealand Universal List of Medicines and Australian Medicines Terminology. Free text entry should only be used if there is no appropriate terminology available.</items>\r\n              <items id=\"description\">Identification of a substance, or substance class, that is considered to put the individual at risk of an adverse reaction event.</items>\r\n              <items id=\"source\">openEHR,FHIR,DAM</items>\r\n              <items id=\"text\">Substance</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0006\">\r\n              <items id=\"comment\">For example: including reason for flagging a 'Criticality' of 'High risk'; and instructions related to future exposure or administration of the Substance, such as administration within an Intensive Care Unit or under corticosteroid cover.</items>\r\n              <items id=\"description\">Additional narrative about the propensity for the adverse reaction, not captured in other fields.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Comment</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0009\">\r\n              <items id=\"description\">Details about each adverse reaction event linked to exposure to the identified 'Substance'.</items>\r\n              <items id=\"source\">openEHR,FHIR,DAM</items>\r\n              <items id=\"text\">Reaction event</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0010\">\r\n              <items id=\"comment\">For example: 'Amoxycillin'. Only an individual substance is a valid entry in 'Specific substance'. If the value in 'Substance' is an individual substance and not a substance class, then it may be duplicated in this data element. It is strongly recommended that 'Specific substance' be coded with a terminology capable of triggering decision support, where possible.  For example: RxNorm, Snomed CT, DM+D, NDFRT, ICD-9, ICD-10, UNI, ATC and CPT. Free text entry should only be used if there is no appropriate terminology available.</items>\r\n              <items id=\"description\">Identification of the substance considered to be responsible for the specific adverse reaction event.</items>\r\n              <items id=\"source\">FHIR, openEHR,DAM</items>\r\n              <items id=\"text\">Specific substance</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0011\">\r\n              <items id=\"comment\">Manifestation can be expressed as a single word, phrase or brief description. For example: nausea, rash.  'No reaction'may be appropriate where a previous reaction has been noted but the reaction did not re-occur after further exposure. It is preferable that 'Manifestation' should be coded with a terminology, where possible. The values entered here may be used to display on an application screen as part of a list of adverse reactions, as recommended in the UK NHS CUI guidelines.\r\n\r\n\r\n\r\nTerminologies commonly used include, but are not limited to, SNOMED-CT or ICD10.</items>\r\n              <items id=\"description\">Clinical symptoms and/or signs that are observed or associated with the adverse reaction.</items>\r\n              <items id=\"source\">FHIR, openEHR,DAM</items>\r\n              <items id=\"text\">Manifestation</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0012\">\r\n              <items id=\"description\">Narrative description about the adverse reaction as a whole, including details of the manifestation if required.</items>\r\n              <items id=\"source\">FHIR, openEHR</items>\r\n              <items id=\"text\">Reaction description</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0018\">\r\n              <items id=\"description\">Narrative description about exposure to the identified 'Specific substance'.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Exposure description</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0020\">\r\n              <items id=\"comment\">Exposure can be more complicated by more than one exposure events leading to a reaction. Further details about the nature of the exposure can be provided by use of additional archetypes in the 'Exposure details' SLOT or as text in the 'Exposure description'.</items>\r\n              <items id=\"description\">Record of the date and/or time of the first exposure to the Substance for this Reaction Event.</items>\r\n              <items id=\"source\">FHIR, openEHR,DAM</items>\r\n              <items id=\"text\">Initial exposure</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0021\">\r\n              <items id=\"description\">Statement about the degree of clinical certainty that the identified 'Specific substance' was the cause of the 'Manifestation' in this reaction event.</items>\r\n              <items id=\"source\">FHIR</items>\r\n              <items id=\"text\">Certainty</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0023\">\r\n              <items id=\"description\">A reasonable level of clinical certainty that the reaction was caused by the identified 'Specific substance'.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Likely</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0025\">\r\n              <items id=\"description\">The total amount of time the individual was exposed to the identified 'Specific substance'.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Duration of exposure</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0027\">\r\n              <items id=\"description\">Record of the date and/or time of the onset of the reaction.</items>\r\n              <items id=\"source\">openEHR, FHIR, DAM</items>\r\n              <items id=\"text\">Onset of reaction</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0028\">\r\n              <items id=\"description\">The total amount of time that the manifestation of the adverse reaction persisted.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Duration of reaction</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0029\">\r\n              <items id=\"comment\">May include structured detail about symptoms; the anatomical location of the manifestation; grading, classification or formal severity assessments such as Common Terminology Criteria for Adverse Events; or the Multimedia CLUSTER archetype. [Note: FHIR - These would be extensions as specified in a profile.]</items>\r\n              <items id=\"description\">Additional details about the adverse reaction, including anatomical location and Common Toxicity Criteria, can be provided by inclusion of specific archetypes in this SLOT.</items>\r\n              <items id=\"source\">FHIR, openEHR</items>\r\n              <items id=\"text\">Reaction details</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0032\">\r\n              <items id=\"description\">Additional narrative about the adverse reaction event not captured in other fields.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Reaction comment</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0040\">\r\n              <items id=\"description\">Narrative description about the clinical management provided.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Clinical management description</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0041\">\r\n              <items id=\"description\">Additional structured details required for reporting to regulatory bodies can be provided by inclusion of specific archetypes in this SLOT.</items>\r\n              <items id=\"source\">FHIR, openEHR</items>\r\n              <items id=\"text\">Reporting details</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0042\">\r\n              <items id=\"description\">@ internal @</items>\r\n              <items id=\"text\">Tree</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0044\">\r\n              <items id=\"description\">Has the adverse reaction ever been reported to a regulatory body?</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Reaction reported?</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0045\">\r\n              <items id=\"description\">Link to an adverse reaction Report sent to a regulatory body.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Adverse reaction report</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0047\">\r\n              <items id=\"comment\">For example, presenting symptoms, examination findings, diagnosis etc.\r\n [Note: FHIR,DAM: Maps to Sensitivity Test.]</items>\r\n              <items id=\"description\">Link to further information about the presentation and findings that exist elsewhere in the health record, including allergy test reports.</items>\r\n              <items id=\"source\">FHIR, openEHR, DAM</items>\r\n              <items id=\"text\">Supporting clinical record information</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0048\">\r\n              <items id=\"comment\">For example, the reason for non-reporting.</items>\r\n              <items id=\"description\">Narrative about the adverse reaction report or reporting process.</items>\r\n              <items id=\"source\">openEHR</items>\r\n              <items id=\"text\">Report comment</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0058\">\r\n              <items id=\"comment\">Immune-mediated responses have been traditionally regarded as an indicator for escalation of significant future risk. Contemporary knowledge suggests that some reactions previously thought to be immune are actually non-immune and still carry life threatening risk. \r\n\r\nImmunological testing may provide supporting evidence for the mechanism and causative substance , but no tests are 100% sensitive or specific for a sensitivity. \r\n\r\nIt is acknowledged that most clinicians will NOT be able to distinguish the mechanism of any specific reaction. However this data element is included because many legacy systems have captured this attribute.</items>\r\n              <items id=\"description\">Identification of the underlying physiological mechanism for the adverse reaction.</items>\r\n              <items id=\"source\">FHIR, DAM</items>\r\n              <items id=\"text\">Reaction mechanism</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0059\">\r\n              <items id=\"description\">Immune mediated reaction, including allergic reactions and hypersensitivities.</items>\r\n              <items id=\"text\">Immune mediated</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0060\">\r\n              <items id=\"description\">A non-immune mediated reaction, which can include pseudo-allergic reactions, side effects, intolerances, drug toxicities (for example, to Gentamicin).</items>\r\n              <items id=\"text\">Non-immune mediated</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0062\">\r\n              <items id=\"comment\">Note: maps to recordedDate in FHIR.</items>\r\n              <items id=\"description\">Date when the propensity or the reaction event was updated.</items>\r\n              <items id=\"source\">openEHR, FHIR, DAM</items>\r\n              <items id=\"text\">Last updated</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0063\">\r\n              <items id=\"comment\">Decision support would typically raise alerts for 'Suspected', 'Likely', 'Confirmed', and ignore a 'Refuted' reaction. Clinical systems may choose not to display Adverse reaction entries with a \r\n\r\n\r\n'Refuted' status in the Adverse Reaction List. \r\n\r\nHowever, 'Refuted' may be useful for reconciliation of the adverse reaction list or when communicating between systems\r\n\r\n. Some implementations may choose to make this field mandatory.\r\n 'Resolved' may be used variably across systems, depending on clinical use and context - there appears to be differing opinion whether this should still be used to raise potential alerts or to display in an Adverse Reaction List. The free text data type will allow for local variation by enabling other value sets to be applied to this data element in a template - in this situation it is recommended that values should be coded using a terminology.</items>\r\n              <items id=\"description\">Assertion about the certainty of the propensity, or potential future risk, of the identified 'Substance' to cause a reaction.</items>\r\n              <items id=\"source\">FHIR, DAM</items>\r\n              <items id=\"text\">Status</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0064\">\r\n              <items id=\"description\">A reasonable level of certainty about the propensity for a reaction to the identified 'Substance'.</items>\r\n              <items id=\"text\">Likely</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0065\">\r\n              <items id=\"description\">A high level of certainty about the propensity for a reaction to the identified 'Substance', which may include clinical evidence by testing or re-challenge.</items>\r\n              <items id=\"text\">Confirmed</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0066\">\r\n              <items id=\"description\">The propensity for a reaction to the identified 'Substance' has been clinically reassessed or has been disproved with a high level of clinical certainty by re-exposure or deliberate challenge.</items>\r\n              <items id=\"text\">Refuted</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0067\">\r\n              <items id=\"description\">The previously known reaction to the identified 'Substance' has been clinically reassessed and considered no longer to be an active risk.</items>\r\n              <items id=\"text\">Resolved</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0089\">\r\n              <items id=\"comment\">It is acknowledged that this assessment is very subjective. There may be some some specific practice domains where objective scales have been applied.\r\n Objective scales can be included in this model using the 'Reaction details' Cluster.</items>\r\n              <items id=\"description\">Clinical assessment of the severity of the reaction event as a whole, potentially considering multiple different manifestations.</items>\r\n              <items id=\"source\">DAM</items>\r\n              <items id=\"text\">Severity of reaction</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0090\">\r\n              <items id=\"description\">Causes severe physiological effects.</items>\r\n              <items id=\"source\">FHIR</items>\r\n              <items id=\"text\">Severe</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0092\">\r\n              <items id=\"description\">Causes moderate physiological effects.</items>\r\n              <items id=\"source\">FHIR</items>\r\n              <items id=\"text\">Moderate</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0093\">\r\n              <items id=\"description\">Causes mild physiological effects.</items>\r\n              <items id=\"source\">FHIR</items>\r\n              <items id=\"text\">Mild</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0095\">\r\n              <items id=\"description\">A low level of clinical certainty that the reaction was caused by the identified 'Specific substance'.</items>\r\n              <items id=\"text\">Suspected</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0096\">\r\n              <items id=\"description\">Additional details about exposure to the 'Specific substance', especially in situations where there may have been multiple or cumulative exposures can be provided by inclusion of specific archetypes in this SLOT.</items>\r\n              <items id=\"text\">Exposure details</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0099\">\r\n              <items id=\"description\">Structured details about reports that have been forwarded to regulatory bodies.</items>\r\n              <items id=\"text\">Report summary</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0101\">\r\n              <items id=\"comment\">This can be regarded as a predictive judgement of a 'worst case scenario'.\r\n In most contexts 'Low' would be regarded as the default value.</items>\r\n              <items id=\"description\">An indication of the potential for critical system organ damage or life threatening consequence.</items>\r\n              <items id=\"source\">DAM, openEHR</items>\r\n              <items id=\"text\">Criticality</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0102\">\r\n              <items id=\"description\">Exposure to substance unlikely to result in critical system organ damage or life threatening consequence. Future exposure to the identified 'Substance' should be considered a relative contra-indication in normal clinical circumstances.</items>\r\n              <items id=\"text\">Low</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0103\">\r\n              <items id=\"description\">Exposure to substance may result in critical organ system damage or life threatening consequence. Future exposure to the identified 'Substance' should be considered an absolute contra-indication in normal clinical circumstances.</items>\r\n              <items id=\"text\">High</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0106\">\r\n              <items id=\"comment\">Coding of the Route of Exposure with a terminology should be used wherever possible.</items>\r\n              <items id=\"description\">Identification of the route by which the subject was exposed to the identified 'Specific substance'.</items>\r\n              <items id=\"source\">FHIR, DAM</items>\r\n              <items id=\"text\">Route of exposure</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0116\">\r\n              <items id=\"description\">Details about the provenance of the information can be provided by inclusion of specific archetypes in this SLOT.</items>\r\n              <items id=\"text\">Information source</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0117\">\r\n              <items id=\"comment\">This date may be be a duplicate of the most recent 'Onset of reaction' date.\r\n Where a textual representation of the date of last occurrence is required e.g 'In Childhood, '10 years ago' the Comment element should be used.</items>\r\n              <items id=\"description\">The date and/or time of the onset of the last known occurrence of a reaction event.</items>\r\n              <items id=\"source\">IMH</items>\r\n              <items id=\"text\">Onset of last reaction</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0118\">\r\n              <items id=\"description\">A high level of clinical certainty that the reaction was due to the identified 'Substance', which may include clinical evidence by testing or re-challenge.</items>\r\n              <items id=\"text\">Confirmed</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0119\">\r\n              <items id=\"description\">Additional structured details about clinical management for this reaction event can be provided by inclusion of specific archetypes in this SLOT.</items>\r\n              <items id=\"text\">Clinical management details</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0120\">\r\n              <items id=\"comment\">This data element has been included because it is currently being captured in some clinical systems. This data can be derived from the Substance where coding systems are used, and is effectively redundant in that situation.</items>\r\n              <items id=\"description\">Category of the identified 'Substance'.</items>\r\n              <items id=\"text\">Category</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0121\">\r\n              <items id=\"description\">Any substance consumed to provide nutritional support for the body, such as peanut or egg.</items>\r\n              <items id=\"text\">Food</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0122\">\r\n              <items id=\"description\">Any substance administered to achieve a physiological effect.</items>\r\n              <items id=\"text\">Medication</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0123\">\r\n              <items id=\"description\">Any other substance encountered including venom, latex and other environmental substances.</items>\r\n              <items id=\"text\">Other</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0124\">\r\n              <items id=\"description\">Unable to assess with information available.</items>\r\n              <items id=\"text\">Indeterminate</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0125\">\r\n              <items id=\"description\">Date that the report was sent to the regulatory authority.</items>\r\n              <items id=\"text\">Date of report</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0126\">\r\n              <items id=\"description\">The physiological mechanism could not be determined.</items>\r\n              <items id=\"text\">Indeterminate</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0127\">\r\n              <items id=\"description\">A low level of clinical certainty about the propensity of a reaction to the identified 'Substance'.</items>\r\n              <items id=\"text\">Suspected</items>\r\n            </term_definitions>\r\n            <term_definitions code=\"at0128\">\r\n              <items id=\"comment\">For example: local information requirements or additional metadata to align with FHIR or CIMI equivalents.</items>\r\n              <items id=\"description\">Additional information required to capture local content or to align with other reference models/formalisms.</items>\r\n              <items id=\"text\">Extension</items>\r\n            </term_definitions>\r\n          </children>\r\n          <cardinality>\r\n            <is_ordered>false</is_ordered>\r\n            <is_unique>false</is_unique>\r\n            <interval>\r\n              <lower_included>true</lower_included>\r\n              <lower_unbounded>false</lower_unbounded>\r\n              <upper_unbounded>true</upper_unbounded>\r\n              <lower>0</lower>\r\n            </interval>\r\n          </cardinality>\r\n        </attributes>\r\n        <archetype_id>\r\n          <value>openEHR-EHR-SECTION.allergies_adverse_reactions_rcp.v1</value>\r\n        </archetype_id>\r\n        <term_definitions code=\"at0000\">\r\n          <items id=\"description\">Allergies and adverse reactions heading (AoMRC).</items>\r\n          <items id=\"text\">Allergies and adverse reactions</items>\r\n        </term_definitions>\r\n      </children>\r\n      <cardinality>\r\n        <is_ordered>false</is_ordered>\r\n        <is_unique>false</is_unique>\r\n        <interval>\r\n          <lower_included>true</lower_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>true</upper_unbounded>\r\n          <lower>0</lower>\r\n        </interval>\r\n      </cardinality>\r\n    </attributes>\r\n    <archetype_id>\r\n      <value>openEHR-EHR-COMPOSITION.adverse_reaction_list.v1</value>\r\n    </archetype_id>\r\n    <template_id>\r\n      <value>IDCR -  Adverse Reaction List.v1</value>\r\n    </template_id>\r\n    <term_definitions code=\"at0000\">\r\n      <items id=\"description\">A persistent and managed list of adverse reactions experienced by the subject that may influence clinical decision-making and care provision.</items>\r\n      <items id=\"text\">Adverse reaction list</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0001\">\r\n      <items id=\"description\">@ internal @</items>\r\n      <items id=\"text\">Tree</items>\r\n    </term_definitions>\r\n    <term_definitions code=\"at0002\">\r\n      <items id=\"comment\">For example: Local hospital departmental infomation or additional metadata to align with FHIR or CIMI equivalents.</items>\r\n      <items id=\"description\">Additional information required to capture local context or to align with other reference models/formalisms.</items>\r\n      <items id=\"text\">Extension</items>\r\n    </term_definitions>\r\n  </definition>\r\n  <constraints>\r\n    <attributes>\r\n      <rm_attribute_name>value</rm_attribute_name>\r\n      <children>\r\n        <rm_type_name>DV_TEXT</rm_type_name>\r\n        <occurrences>\r\n          <lower_included>true</lower_included>\r\n          <upper_included>true</upper_included>\r\n          <lower_unbounded>false</lower_unbounded>\r\n          <upper_unbounded>false</upper_unbounded>\r\n          <lower>1</lower>\r\n          <upper>1</upper>\r\n        </occurrences>\r\n        <node_id />\r\n        <default_value xsi:type=\"DV_TEXT\">\r\n          <value>No history of allergies / adverse reactions</value>\r\n        </default_value>\r\n      </children>\r\n      <differential_path>[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]/content[openEHR-EHR-SECTION.allergies_adverse_reactions_rcp.v1]/items[openEHR-EHR-EVALUATION.exclusion-adverse_reaction.v1]/data[at0001]/items[at0002.1]</differential_path>\r\n    </attributes>\r\n  </constraints>\r\n  <view>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]/content[openEHR-EHR-SECTION.allergies_adverse_reactions_rcp.v1]/items[openEHR-EHR-EVALUATION.exclusion-adverse_reaction.v1]/data[at0001]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]/content[openEHR-EHR-SECTION.allergies_adverse_reactions_rcp.v1]/items[openEHR-EHR-EVALUATION.exclusion-adverse_reaction.v1]/protocol[at0006]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]/content[openEHR-EHR-SECTION.allergies_adverse_reactions_rcp.v1]/items[openEHR-EHR-EVALUATION.adverse_reaction_risk.v1]/data[at0001]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n    <constraints path=\"[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]/context/other_context[at0001]\">\r\n      <items id=\"pass_through\">\r\n        <value>true</value>\r\n      </items>\r\n    </constraints>\r\n  </view>\r\n</template>";
var urlString = openEhrApi.concat('/rest/v1/session?username=guest&password=guest');
  
var settings = {
    "async": true,
    "crossDomain": true,
    type: 'POST',
    url: urlString,
    data: null,
    dataType: 'text'
}

$.ajax(settings).done(function (response) {
  console.log(response);
  var jsonData = JSON.parse(response);
  //document.getElementById("p3").innerHTML = response;

  var success = "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>Session ID in the Response</td><td><font COLOR='green'>PASS</font></td></tr></tbody></table>";

  var fail= "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>Session ID in the Response</td><td><font COLOR='red'>FAIL</font></td></tr></tbody></table>";
  if('sessionId' in jsonData ){
      document.getElementById("createSessionTests").innerHTML = success;
        Ehr_Session = jsonData.sessionId;
        document.getElementById("p5").innerHTML = Ehr_Session;

  }else{
      document.getElementById("createSessionTests").innerHTML = fail;
  }
});


$("#createNewEhrFromSubjectId").click(function(){
  urlString = openEhrApi.concat('/rest/v1/ehr?subjectId=', subjectId, '&subjectNamespace=' ,subjectNamespace, '&commiterName=', committerName);
  var settings2 = {
      type: 'POST',
      url: urlString,
      crossDomain: true,   
      data: "{\r\n    \"ctx/composer_name\": \"Dr Mary Johnson\",\r\n\t\t\"ctx/composer_id\": \"G33561\",\r\n    \"ctx/health_care_facility|id\": \"999999-378\",\r\n    \"ctx/health_care_facility|name\": \"Ripple Valley Hospital NHS\",\r\n    \"ctx/id_namespace\": \"NHS-UK\",\r\n    \"ctx/id_scheme\": \"2.16.840.1.113883.2.1.4.3\",\r\n    \"ctx/language\": \"en\",\r\n    \"ctx/territory\": \"GB\",\r\n    \"ctx/time\": \"2015-10-22T00:11:02.518+02:00\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/date_time_of_onset\": \"2000-07-17T12:30:37.553Z\",\r\n\t\t\"problem_list/problems_and_issues:0/problem_diagnosis:0/date_time_clinically_recognised\": \"2000-07-17\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/diagnostic_certainty|code\": \"at0074\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/diagnostic_certainty|terminology\": \"local\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/diagnostic_certainty|value\": \"Suspected\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|code\": \"299757012\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|terminology\": \"SNOMED-CT\",\r\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|value\": \"cold\"\r\n    \r\n}",
      async: true,
      headers: {  
        'content-type': 'application/json;charset=ISO-8859-15',
        'authorization': '{{Authorization}}',
        'Ehr-Session': Ehr_Session,
        'cache-control': 'no-cache'
      },
      processData: false
  }

  $.ajax(settings2).done(function (response2) {
    console.log(response2);
    ehrId = response2.ehrId;


    var test1 = false;
    var test2 = false;
    var test3 = true;
    if (response2.hasOwnProperty('ehrId')) {
      test1 = true;
    }
    if(response2.action === 'CREATE'){
      test2=true;
    }
    if(!response2.ehrId){
      test2 = false;
    }
    
    var tablecontent1 = "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>EhrId field exists</td>";    
    var tablecontent2 = "</tr><tr><td>Action is CREATE</td>";
    var tablecontent3="</tr><tr><td>EhrID is not null</td>";
    var tablecontent4="</tr></tbody></table>";
    var table;
    if(test1){
      table = tablecontent1.concat(lineSuccess);
    }else{
      table = tablecontent1.concat(lineFailure);
    }
    if(test2){
        table = table.concat(tablecontent2, lineSuccess);
    }else{
        table = table.concat(tablecontent2, lineFailure);
    }
    if(test3){
        table = table.concat(tablecontent3, lineSuccess, tablecontent4);
    }else{
        table = table.concat(tablecontent3, lineFailure, tablecontent4);
    }


      document.getElementById("createEhrIDTests").innerHTML = table;
      document.getElementById("p8").innerHTML = ehrId;
      //document.getElementById("p8").innerHTML = response2;
  });
});


$("#getEhrStatusFromSubjectId").click(function(){
    var urlString = openEhrApi.concat('/rest/v1/ehr/?subjectId=', subjectId, '&subjectNamespace=', subjectNamespace);
    console.log(Ehr_Session);
    var settings3 = {
      "async": true,
      "crossDomain": true,
      "url": urlString,
      "method": "GET",
      "headers": {
      "content-type": "application/json",
      "Ehr-Session": Ehr_Session,
      "cache-control": "no-cache"
  }
}

  $.ajax(settings3).done(function (response3) {
    console.log(response3);
    if (response3.hasOwnProperty('ehrId')) {
      console.log("pass test");
    }
    var tablecontent1 = "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>Body contains EHR ID</td>";    
    var tablecontent2 = "</tr><tr><td>ehrStatus exists</td>";
    var tablecontent3="</tr><tr><td>subject ID exists</td>";
    var tablecontent4="</tr><tr><td>id_value exists</td>";
    var tablecontent5="</tr><tr><td>subjectID remain the same</td>";
    var tablecontent6="</tr></tbody></table>";
    var test1=false; 
    var test2=false;
    var test3=false;
    var test4=false;
    var test5=false;
    ehrId = response3.ehrId;
    if (response3.hasOwnProperty('ehrId')) {
      test1 = true;
    }
    if (response3.hasOwnProperty('ehrStatus')) {
      test2 = true;
    }
    if (response3.ehrStatus.hasOwnProperty('subjectIds')) {
      test3 = true;
    }
    if (response3.ehrStatus.subjectIds.hasOwnProperty('id_value')) {
      test4 = true;
    }
    if(subjectId==response3.ehrStatus.subjectIds.id_value){
      test5=true;
    }


    if(test1){
      table = tablecontent1.concat(lineSuccess);
    }else{
      table = tablecontent1.concat(lineFailure);
    }
    if(test2){
        table = table.concat(tablecontent2, lineSuccess);
    }else{
        table = table.concat(tablecontent2, lineFailure);
    }
    if(test3){
        table = table.concat(tablecontent3, lineSuccess);
    }else{
        table = table.concat(tablecontent3, lineFailure);
    }
    if(test4){
        table = table.concat(tablecontent4, lineSuccess);
    }else{
        table = table.concat(tablecontent4, lineFailure);
    }
    if(test5){
        table = table.concat(tablecontent5, lineSuccess, tablecontent6);
    }else{
        table = table.concat(tablecontent5, lineFailure, tablecontent6);
    }
    document.getElementById("getEhrStatusTests").innerHTML = table;
    document.getElementById("p11").innerHTML = ehrId;

  });
});

$("#ProblemsUploadTemplate").click(function(){
    var urlTemplate = openEhrApi.concat('/rest/v1/template/');
    var settings4 = {
      "async": true,
      "crossDomain": true,
      "url": urlTemplate,
      "method": "POST",
      "headers": {
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "content-type": "application/xml",
        "cache-control": "no-cache"
      },
      "data": dataTemp
    }

    $.ajax(settings4).done(function (response4) {
      console.log(response4);
      var res = response4.templateId;
      templateId = res.replace(/ /g, "%20"); 
      var actionT = response4.action;
      document.getElementById("p15").innerHTML = response4.templateId;
      document.getElementById("p21").innerHTML = actionT;

      var test1 = false;
      var test2 = false;
      var test3 = true;
      var tablecontent1 = "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>action is commit</td>";    
      var tablecontent2 = "</tr><tr><td>template ID exists</td>";
      var tablecontent3="</tr><tr><td>templateId is not empty</td>";
      var tablecontent4="</tr></tbody></table>";
      var test1=false; 
      var test2=false;
      var test3=true;
      if(response4.action === 'CREATE'){
        test1=true;
      }
      if (response4.hasOwnProperty('templateId')) {
        test2 = true;
      }
      if(!response4.templateId){
        test3 = false;
      }
      var table;
      if(test1){
        table = tablecontent1.concat(lineSuccess);
      }else{
        table = tablecontent1.concat(lineFailure);
      }
      if(test2){
          table = table.concat(tablecontent2, lineSuccess);
      }else{
          table = table.concat(tablecontent2, lineFailure);
      }
      if(test3){
          table = table.concat(tablecontent3, lineSuccess, tablecontent4);
      }else{
          table = table.concat(tablecontent3, lineFailure, tablecontent4);
      }
      document.getElementById("UploadTemplateTests").innerHTML = table;

    });
});

$("#ProblemsCommitComposition").click(function(){
    var urlCommit = openEhrApi.concat('/rest/v1/composition?ehrId=', ehrId, '&templateId=', templateId, '&committerName=', committerName, '&format=FLAT' );
    var settings5 = {
      "async": true,
      "crossDomain": true,
      "url": urlCommit,
      "method": "POST",
      "headers": {
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "content-type": "application/json",
        "cache-control": "no-cache"
      },
      "processData": false,
      "data": "{\n    \"ctx/composer_name\": \"Dr Mary Johnson\",\n\t\t\"ctx/composer_id\": \"G33561\",\n    \"ctx/health_care_facility|id\": \"999999-378\",\n    \"ctx/health_care_facility|name\": \"Ripple Valley Hospital NHS\",\n    \"ctx/id_namespace\": \"NHS-UK\",\n    \"ctx/id_scheme\": \"2.16.840.1.113883.2.1.4.3\",\n    \"ctx/language\": \"en\",\n    \"ctx/territory\": \"GB\",\n    \"ctx/time\": \"2015-10-22T00:11:02.518+02:00\",\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/date_time_of_onset\": \"2000-07-17T12:30:37.553Z\",\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|code\": \"299757012\",\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|terminology\": \"SNOMED-CT\",\n    \"problem_list/problems_and_issues:0/problem_diagnosis:0/problem_diagnosis_name|value\": \"allergie\"    \n}"
    }
    $.ajax(settings5).done(function (response5) {
      console.log(response5);
      var res = response5.compositionUid;
      compositionUid = res; 
      var actionT = response5.action;
      var test1 = false;
      var test2 = false;
      var table;
      var tablecontent1 = "<table><tbody><tr><td><b>Tests</b></td></tr><tr><td>composition ID exists</td>";    
      var tablecontent2 = "</tr><tr><td>action is commit</td>";
      var tablecontent3="</tr></tbody></table>";
      if (response5.hasOwnProperty('compositionUid')) {
        test1 = true;
      }
      if(response5.action == 'CREATE'){
        test2=true;
      }
      if(test1){
        table = tablecontent1.concat(lineSuccess);
      }else{
        table = tablecontent1.concat(lineFailure);
      }
      if(test2){
          table = table.concat(tablecontent2, lineSuccess, tablecontent3);
      }else{
          table = table.concat(tablecontent2, lineFailure, tablecontent3);
      }
      document.getElementById("CommitCompositionTests").innerHTML = table;
      document.getElementById("p18").innerHTML = compositionUid;
      document.getElementById("p20").innerHTML = actionT;
    });
});

$("#ProblemsReadComposition").click(function(){
    var urlRComp = openEhrApi.concat('/rest/v1/composition/', compositionUid, '?format=FLAT');
    var settings6 = {
      "async": true,
      "crossDomain": true,
      "url": urlRComp,
      "method": "GET",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache"
      }
    }

    $.ajax(settings6).done(function (response6) {
      console.log(response6);
      var res = response6.composition;
      var res2 = res['problem_list/_uid'];
      var templateReturn = response6.templateId;
      document.getElementById("p24").innerHTML = res2;
      document.getElementById("p26").innerHTML = templateReturn;
    });
});

$("#ProblemsDeleteComposition").click(function(){
      var urlDelete = openEhrApi.concat('/rest/v1/composition/', compositionUid);
      var settings7 = {
        "async": true,
        "crossDomain": true,
        "url": urlDelete,
        "method": "DELETE",
        "headers": {
          "content-type": "application/json",
          "authorization": "{{Authorization}}",
          "Ehr-Session": Ehr_Session,
          "cache-control": "no-cache",
        }
      }

    $.ajax(settings7).done(function (response7) {
      console.log(response7);
      var res = response7.compositionUid;
      compositionUid = res; 
      var actionT = response7.action;
      document.getElementById("p29").innerHTML = compositionUid;
      document.getElementById("p31").innerHTML = actionT;    
    });
});

$("#ProblemsQueryPatientCompositions").click(function(){
    var query = "{\n    \"aql\": \"select   a/uid/value as uid,   a/composer/name as author,   a/context/start_time/value as date_created,   b_a/data[at0001]/items[at0002]/value/value as problem,    b_a/data[at0001]/items[at0002]/value/defining_code/code_string as problem_code,    b_a/data[at0001]/items[at0002]/value/defining_code/terminology_id/value as problem_terminology,    b_a/data[at0001]/items[at0009]/value/value as description,    b_a/data[at0001]/items[at0077]/value/value as onset_date  from EHR e [ehr_id/value = '";
    var aqlquery = query.concat(ehrId, "']  contains COMPOSITION a[openEHR-EHR-COMPOSITION.problem_list.v1]  contains EVALUATION b_a[openEHR-EHR-EVALUATION.problem_diagnosis.v1]  where a/name/value='Problem list'\"\n}");
    var urlQuery = openEhrApi.concat('/rest/v1/query');
    var settings8 = {
      "async": true,
      "crossDomain": true,
      "url": urlQuery,
      "method": "POST",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache",
      },
      "processData": false,
      "data": aqlquery
    }

    $.ajax(settings8).done(function (response8) {
      console.log(response8);
      var res = response8.resultSet[0].uid;
      var patientName = response8.resultSet[0].author;
      document.getElementById("p34").innerHTML = res;
      document.getElementById("p36").innerHTML = patientName;

    });
});
$("#ProblemsQueryAllCompositions").click(function(){
    var query = "{\n    \"aql\": \"select   a/uid/value as uid,   a/composer/name as author,   a/context/start_time/value as date_created,   b_a/data[at0001]/items[at0002]/value/value as problem,    b_a/data[at0001]/items[at0002]/value/defining_code/code_string as problem_code,    b_a/data[at0001]/items[at0002]/value/defining_code/terminology_id/value as problem_terminology,    b_a/data[at0001]/items[at0009]/value/value as description,    b_a/data[at0001]/items[at0077]/value/value as onset_date  from EHR e ";
    var aqlquery = query.concat(" contains COMPOSITION a[openEHR-EHR-COMPOSITION.problem_list.v1]  contains EVALUATION b_a[openEHR-EHR-EVALUATION.problem_diagnosis.v1]  where a/name/value='Problem list'\"\n}");
    var urlQuery = openEhrApi.concat('/rest/v1/query');
    var settings9 = {
      "async": true,
      "crossDomain": true,
      "url": urlQuery,
      "method": "POST",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache",
      },
      "processData": false,
      "data": aqlquery
    }

    $.ajax(settings9).done(function (response9) {
      console.log(response9);
      var res = response9.resultSet[0].uid;
      var patientName = response9.resultSet[0].author;
      document.getElementById("p39").innerHTML = res;
      document.getElementById("p41").innerHTML = patientName;

    });
});

$("#AllergiesUploadTemplate").click(function(){
    var urlTemplate = openEhrApi.concat('/rest/v1/template/');
    var settings10 = {
      "async": true,
      "crossDomain": true,
      "url": urlTemplate,
      "method": "POST",
      "headers": {
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "content-type": "application/xml",
        "cache-control": "no-cache"
      },
      "data": tempAllergies
    }

    $.ajax(settings10).done(function (response10) {
      console.log(response10);
      var res = response10.templateId;
      templateId = res.replace(/ /g, "%20"); 
      var actionT = response10.action;
      document.getElementById("p44").innerHTML = response10.templateId;
      document.getElementById("p46").innerHTML = actionT;
    });
});


$("#AllergiesCommitComposition").click(function(){
    var urlCommit = openEhrApi.concat('/rest/v1/composition?ehrId=', ehrId, '&templateId=', templateId, '&committerName=', committerName, '&format=FLAT' );
    var settings11 = {
      "async": true,
      "crossDomain": true,
      "url": urlCommit,
      "method": "POST",
      "headers": {
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "content-type": "application/json",
        "cache-control": "no-cache",
      },
      "processData": false,
      "data": "{\n  \"ctx/composer_name\": \"Dr Mary Johnson\",\n  \"ctx/health_care_facility|id\": \"999999-378\",\n  \"ctx/health_care_facility|name\": \"Home\",\n  \"ctx/id_namespace\": \"NHS-UK\",\n  \"ctx/id_scheme\": \"2.16.840.1.113883.2.1.4.3\",\n  \"ctx/language\": \"en\",\n  \"ctx/territory\": \"GB\",\n  \"ctx/time\": \"2016-12-20T00:11:02.518+02:00\",\n  \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/causative_agent|code\": \"91936005\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/causative_agent|value\": \"allergy to penicillin\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/causative_agent|terminology\": \"SNOMED-CT\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/reaction_details/manifestation:0|code\": \"28926001\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/reaction_details/manifestation:0|value\": \"eruption due to drug\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/reaction_details/manifestation:0|terminology\": \"SNOMED-CT\",\n   \"adverse_reaction_list/allergies_and_adverse_reactions/adverse_reaction_risk:0/reaction_details/comment\": \"History unclear\"\n}"    }
    
    $.ajax(settings11).done(function (response11) {
      console.log(response11);
      var res = response11.compositionUid;
      compositionUid = res; 
      var actionT = response11.action;
      document.getElementById("p49").innerHTML = compositionUid;
      document.getElementById("p51").innerHTML = actionT;
    });
});

$("#AllergiesReadComposition").click(function(){
    var urlRComp = openEhrApi.concat('/rest/v1/composition/', compositionUid, '?format=FLAT');
    var settings12 = {
      "async": true,
      "crossDomain": true,
      "url": urlRComp,
      "method": "GET",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache"
      }
    }

    $.ajax(settings12).done(function (response12) {
      console.log(response12);
      var res = response12.composition;
      var res2 = res['adverse_reaction_list/_uid'];
      var templateReturn = response12.templateId;
      document.getElementById("p54").innerHTML = res2;
      document.getElementById("p56").innerHTML = templateReturn;
    });
});

$("#AllergiesDeleteComposition").click(function(){
      var urlDelete = openEhrApi.concat('/rest/v1/composition/', compositionUid);
      var settings13 = {
        "async": true,
        "crossDomain": true,
        "url": urlDelete,
        "method": "DELETE",
        "headers": {
          "content-type": "application/json",
          "authorization": "{{Authorization}}",
          "Ehr-Session": Ehr_Session,
          "cache-control": "no-cache",
        }
      }

    $.ajax(settings13).done(function (response13) {
      console.log(response13);
      var res = response13.compositionUid;
      compositionUid = res; 
      var actionT = response13.action;
      document.getElementById("p59").innerHTML = compositionUid;
      document.getElementById("p61").innerHTML = actionT;    
    });
});

$("#AllergiesQueryPatientCompositions").click(function(){
    var query = "{\n\t\"aql\": \"select   a/uid/value as uid,   a/composer/name as author,   a/context/start_time/value as date_created,   b_a/data[at0001]/items[at0002]/value/value as cause,   b_a/data[at0001]/items[at0002]/value/defining_code/code_string as cause_code,   b_a/data[at0001]/items[at0002]/value/defining_code/terminology_id/value as cause_terminology,   b_a/data[at0001]/items[at0009]/items[at0011]/value/value as reaction,   b_a/data[at0001]/items[at0009]/items[at0011]/value/defining_code/code_string as reaction_code,   b_a/data[at0001]/items[at0009]/items[at0011]/value/terminology_id/value as reaction_terminology  from EHR e [ehr_id/value = '";
    var aqlquery = query.concat(ehrId, "'] contains COMPOSITION a[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]   contains EVALUATION b_a[openEHR-EHR-EVALUATION.adverse_reaction_risk.v1]  where   a/name/value='Adverse reaction list'\"\n}");
    var urlQuery = openEhrApi.concat('/rest/v1/query');
    var settings14 = {
      "async": true,
      "crossDomain": true,
      "url": urlQuery,
      "method": "POST",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache",
      },
      "processData": false,
      "data": aqlquery
    }

    $.ajax(settings14).done(function (response14) {
      console.log(response14);
      var res = response14.resultSet[0].uid;
      var patientName = response14.resultSet[0].author;
      document.getElementById("p64").innerHTML = res;
      document.getElementById("p66").innerHTML = patientName;

    });
});
$("#AllergiesQueryAllCompositions").click(function(){
    var query = "{\n\t\"aql\": \"select   a/uid/value as uid,   a/composer/name as author,   a/context/start_time/value as date_created,   b_a/data[at0001]/items[at0002]/value/value as cause,   b_a/data[at0001]/items[at0002]/value/defining_code/code_string as cause_code,   b_a/data[at0001]/items[at0002]/value/defining_code/terminology_id/value as cause_terminology,   b_a/data[at0001]/items[at0009]/items[at0011]/value/value as reaction,   b_a/data[at0001]/items[at0009]/items[at0011]/value/defining_code/code_string as reaction_code,   b_a/data[at0001]/items[at0009]/items[at0011]/value/terminology_id/value as reaction_terminology  from EHR e ";
    var aqlquery = query.concat(" contains COMPOSITION a[openEHR-EHR-COMPOSITION.adverse_reaction_list.v1]   contains EVALUATION b_a[openEHR-EHR-EVALUATION.adverse_reaction_risk.v1]  where   a/name/value='Adverse reaction list'\"\n}");
    var urlQuery = openEhrApi.concat('/rest/v1/query');
    var settings15 = {
      "async": true,
      "crossDomain": true,
      "url": urlQuery,
      "method": "POST",
      "headers": {
        "content-type": "application/json",
        "authorization": "{{Authorization}}",
        "Ehr-Session": Ehr_Session,
        "cache-control": "no-cache",
      },
      "processData": false,
      "data": aqlquery
    }

    $.ajax(settings15).done(function (response15) {
      console.log(response15);
      var res = response15.resultSet[0].uid;
      var patientName = response15.resultSet[0].author;
      document.getElementById("p69").innerHTML = res;
      document.getElementById("p71").innerHTML = patientName;

    });
});